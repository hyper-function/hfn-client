<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hfg client demo</title>
  </head>
  <body>
    <script type="module">
      import * as hfn from "../dist/index.js";
      console.log(hfn);
      window.hfn = hfn;
      const uri = `http://localhost:9356/client/config?id=VYbG1B1W-qhc35VDyvESW`;
      // const uri =
      //   '["VYbG1B1W-qhc35VDyvESW",[],"ws://localhost:3000/hfn",[[0,"","",[[1,[[1,"aseeee","i",1],[4,"wefwefq","0-2",0],[5,"aa","0-5",1],[6,"fefe","0-2",0],[7,"regewrgerg","s",0],[8,"regreg","s",0],[9,"gsdf","s",0],[10,"sadfasefsef","s",0],[11,"gwrtgGFaefewrgfgasfesffsaf","s",0],[12,"tgsdfafergds","s",0],[13,"thdssdfsdafsdergsdfasfe","s",0]]],[2,[]],[14,[[1,"name","s",1],[2,"opop","0-7",0],[3,"id","i",0],[4,"ha","0-16",0]]],[16,[[0,"id","i",0],[1,"s","s",0],[2,"f","f",0],[3,"b","b",0],[4,"t","t",0]]],[17,[]],[18,[[1,"uid","i",0]]],[19,[]],[20,[]],[21,[]]],[[1,"homeView",[[0,1,""],[3,16,"ahaha"],[4,17,"fqwfewf"]],[[1,14,"mount"]]],[2,"bbbbbbbbbb",[[0,2,""]],[]]],[[1,"clclcl",18,19],[2,"asefsef",20,21]]]]]';

      const client = new hfn.HyperFunctionClient(uri);
      client.on("connected", () => {
        console.log("connected");
        // setInterval(() => {
        client.hfn(
          "homeView.mount",
          {
            state: {
              int: 1,
              intArr: [1, 2, 3],
              str: "haha",
              strArr: ["h", "a", "h", "a"],
              bool: true,
              boolArr: [true, false, true],
              float: 1.2,
              floatArr: [1.2, 1.3, 1.4],
              bytes: new Uint8Array([1, 2, 3]),
              bytesArr: [
                new Uint8Array([0xab]),
                new Uint8Array([0xcd]),
                new Uint8Array([0xef])
              ],
              nested: {
                id: 123,
                s: "abab"
              },
              nestedArr: [
                {
                  id: 123,
                  s: "abab"
                },
                {
                  id: 456,
                  s: "cdef"
                }
              ]
            }
          },
          {
            headers: { a: "1", b: "2asdf阿瑟发afsef❤❤️😄" }
          }
        );
        // }, 3000);
      });
      client.subscribe(function (change) {
        console.log(change);
        console.log(change.state.toObject());
      });
    </script>
  </body>
</html>
